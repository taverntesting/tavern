load("@rules_python//python:defs.bzl", "py_library")
load("@tavern_pip//:requirements.bzl", "requirement")
load(":gentest.bzl", "gentest")

package(default_visibility = ["//:__subpackages__"])

# gazelle:ignore

py_library(
    name = "conftest",
    testonly = True,
    srcs = [
        "conftest.py",
    ],
    imports = ["../.."],
    visibility = ["//:__subpackages__"],
    deps = [
        "//tavern",
        "//tavern/_core/internal",
        "//tavern/_core/pytest",
        "//tavern/_core/schema",
        "//tavern/_plugins/mqtt",
        "//tavern/_plugins/rest",
        "//tests:conftest",  # keep
        requirement("faker"),
        requirement("paho_mqtt"),
        requirement("py"),
        requirement("pytest"),
        requirement("pyyaml"),
        requirement("requests"),
    ],
)

[
    gentest(f)
    for f in glob(["**/test_*.py"])
]
